# 封筒の裏で・・・

まずはパフォーマンスをざっくり計算してみましょうよという話

* 1つより2つの答えがあったほうがいい(いろんな切り口で問題を見る)
* 簡単なチェックをする(9去法とか, 72/年利で元金が倍になる年数とか, 常識とか)
* 常に練習する(フェルミ的なやつを自分で考えて)

そして、

* 安全係数をしっかり見積りましょう。2倍で十分ですか！？


## リトルの法則(待ち行列の法則)

待ち行列長 = 平均到着率 x 平均待ち時間


## Q1. ある人が1週間の大雨の後、川が時速320kmで流れたと言っていたが本当か？

時速320kmといえば新幹線より早いが、  
新幹線より速いスピードで流れている物体を見たことはない。  
(24mの滝でもそんな速度にはならないらしい)

## Q2. 高速データ線を使うよりリムーバブルディスクを自転車で運ぶ方が早い距離は？

* 自転車: 15km/hour
* 高速データ線: 100Mbps
* データ量: 125GB
* 距離に比例して長くなる高速データ線による運搬時間は無視

125GBのデータ転送にかかる時間は・・・  
`125GB/ 100Mbps = (125 * 8 / 100) * 1000 sec = 10^4 sec = 2.7 hour`

`15km /hour * 2.7 hour = 42kmくらい`

## Q3. フロッピーディスクをいっぱいにするまで文字を入力するのに何時間かかるか?


* 入力速さ 300 charcters / min
* フロッピーディスク: 1.4 MB

`1.4(MB) / 300(bytes/min)  = 1.4 * 10^6 / 300 = 5 * 10^3 (min) = 3.5日`

## Q4. 世界が100万分の1のスピードで動くと？

* インストラクションを実行する時間
* ディスクが1回転する時間
* ディスクのシークする時間
* タイピングする時間

はそれぞれどんくらいになる？

* インストラクションを実行する時間: 2GHzで10clockくらいの命令とすると、1/2 * 10^-9 * 10 * 10^6 = 0.5 * 10^-2 = 0.005 = 5ミリ秒くらい？
* ディスクが1回転する時間: 7200rpmとすると1回転にかかる時間は1/7200(分) * 10^6 = 1.4 * 10^2 = 140 (分)くらい
* ディスクのシークする時間: 平均半回転だとすると140/2=70分くらい
* タイピングする時間: 300 characters/minで名前は14文字なので14/300= 1/20(分) * 10^6 = 5 * 10^4 = 1ヶ月強


## Q5. 9去法の証明と72の法則の正確性


### 9去法
10進法の数値は

`a(n) * 10^n + a(n-1) * 10^(n-1) + .. + a(0) * 10^0`

で表せる。

`(a(n)+a(n-1)) mod 9 === (a(n) * 10 + a(n-1)) mod 9`

が示せればよいはず。

```
(a(n) * 10 + a(n-1)) mod 9 = (((a(n) mod 9) * (10 mod 9)) mod 9 + (a(n-1) mod 9)) mod 9
  = ((a(n) mod 9) mod 9 + (a(n-1) mod 9)) mod9
  = ((a(n) mod 9) + (a(n-1) mod 9)) mod9
  = (a(n) + a(n-1)) mod 9
```

ということで証明できたはず？


### 72の法則

```
(1 + r/100)^n = 2となるとき
なぜ,ほぼほぼr * n = 72となるのか！？
```

`(1+1/n)^n = 2.7`

nが十分大きい時はになるっぽい。
ということはだいたい

`r/100 = 2/2.7 * 1/n`

くらいになりそう。

`n * r = 73.5`

だいたいこんな感じじゃないだろうか？

## Q6. 現在の世界人口は59億人だが2050年にはどうなっているか？年率1.33%の伸び

72 / 1.33 = 54年で約2倍。

なので約118億人くらいになっている。

## Q7-8とばす

## Q9. 1回のトランザクションあたり100回ディスクアクセスするシステムは1時間何トランザクションいけるか？

7200rpmとすると、1/7200(分/回転)なので、シーク時間は1/14400(分)  
一回のトランザクションでかかる時間は1/14400 * 100 = 1/144 (分)  
と言うことは 60 / (1/144) = 60 * 144 = 8640トランザクション

## Q10. 死亡率の計算

平均寿命を70年とすると、1/70 = 1.4 % らしい
なるほど、平均人口が安定しているとすると

```
平均人口=70年*死亡数
なので
死亡率=死亡数/平均人口=1/70となる
```

## Q11. リトルの法則の証明

* 到着率λ = A/Tとする(Aは期間Tに入ってきた個数)
* 出力率X= C/Tとする(Cは期間Tで処理した個数)
* 物がシステム内にいた時間の総和をWとする

レスポンスR=W/Cで、システム内のブツの平均個数L=W/T  
としたらL=RXとなる。もし安定しているシステムならλ=Xとなる。


## Q12. アメリカの小銭の耐用年数が30年だが、どうやって推測する？

自分が持ってる小銭の枚数を数える。  
小銭の数は金持ちも変わらないだろうからそれが平均枚数だと考える。

その枚数に人口をかけるとアメリカにあるコインの総枚数が推測できる。

それを1年あたりの小銭発行枚数で割るとだいたい耐用年数がでるのでは？
